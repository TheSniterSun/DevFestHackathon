{"ast":null,"code":"\"use strict\";\n\n/*jshint esversion: 6 */\nvar Distance = require(\"./distance.js\"),\n  ClusterInit = require(\"./kinit.js\"),\n  eudist = Distance.eudist,\n  mandist = Distance.mandist,\n  dist = Distance.dist,\n  kmrand = ClusterInit.kmrand,\n  kmpp = ClusterInit.kmpp;\nvar MAX = 10000;\n\n/**\n * Inits an array with values\n */\nfunction init(len, val, v) {\n  v = v || [];\n  for (var i = 0; i < len; i++) {\n    v[i] = val;\n  }\n  return v;\n}\nfunction skmeans(data, k, initial, maxit) {\n  var ks = [],\n    old = [],\n    idxs = [],\n    dist = [];\n  var conv = false,\n    it = maxit || MAX;\n  var len = data.length,\n    vlen = data[0].length,\n    multi = vlen > 0;\n  var count = [];\n  if (!initial) {\n    var _idxs = {};\n    while (ks.length < k) {\n      var idx = Math.floor(Math.random() * len);\n      if (!_idxs[idx]) {\n        _idxs[idx] = true;\n        ks.push(data[idx]);\n      }\n    }\n  } else if (initial == \"kmrand\") {\n    ks = kmrand(data, k);\n  } else if (initial == \"kmpp\") {\n    ks = kmpp(data, k);\n  } else {\n    ks = initial;\n  }\n  do {\n    // Reset k count\n    init(k, 0, count);\n\n    // For each value in data, find the nearest centroid\n    for (var i = 0; i < len; i++) {\n      var min = Infinity,\n        _idx = 0;\n      for (var j = 0; j < k; j++) {\n        // Multidimensional or unidimensional\n        var dist = multi ? eudist(data[i], ks[j]) : Math.abs(data[i] - ks[j]);\n        if (dist <= min) {\n          min = dist;\n          _idx = j;\n        }\n      }\n      idxs[i] = _idx; // Index of the selected centroid for that value\n      count[_idx]++; // Number of values for this centroid\n    }\n\n    // Recalculate centroids\n    var sum = [],\n      old = [],\n      dif = 0;\n    for (var _j = 0; _j < k; _j++) {\n      // Multidimensional or unidimensional\n      sum[_j] = multi ? init(vlen, 0, sum[_j]) : 0;\n      old[_j] = ks[_j];\n    }\n\n    // If multidimensional\n    if (multi) {\n      for (var _j2 = 0; _j2 < k; _j2++) {\n        ks[_j2] = [];\n      } // Sum values and count for each centroid\n      for (var _i = 0; _i < len; _i++) {\n        var _idx2 = idxs[_i],\n          // Centroid for that item\n          vsum = sum[_idx2],\n          // Sum values for this centroid\n          vect = data[_i]; // Current vector\n\n        // Accumulate value on the centroid for current vector\n        for (var h = 0; h < vlen; h++) {\n          vsum[h] += vect[h];\n        }\n      }\n      // Calculate the average for each centroid\n      conv = true;\n      for (var _j3 = 0; _j3 < k; _j3++) {\n        var ksj = ks[_j3],\n          // Current centroid\n          sumj = sum[_j3],\n          // Accumulated centroid values\n          oldj = old[_j3],\n          // Old centroid value\n          cj = count[_j3]; // Number of elements for this centroid\n\n        // New average\n        for (var _h = 0; _h < vlen; _h++) {\n          ksj[_h] = sumj[_h] / cj || 0; // New centroid\n        }\n\n        // Find if centroids have moved\n        if (conv) {\n          for (var _h2 = 0; _h2 < vlen; _h2++) {\n            if (oldj[_h2] != ksj[_h2]) {\n              conv = false;\n              break;\n            }\n          }\n        }\n      }\n    }\n    // If unidimensional\n    else {\n      // Sum values and count for each centroid\n      for (var _i2 = 0; _i2 < len; _i2++) {\n        var _idx3 = idxs[_i2];\n        sum[_idx3] += data[_i2];\n      }\n      // Calculate the average for each centroid\n      for (var _j4 = 0; _j4 < k; _j4++) {\n        ks[_j4] = sum[_j4] / count[_j4] || 0; // New centroid\n      }\n      // Find if centroids have moved\n      conv = true;\n      for (var _j5 = 0; _j5 < k; _j5++) {\n        if (old[_j5] != ks[_j5]) {\n          conv = false;\n          break;\n        }\n      }\n    }\n    conv = conv || --it <= 0;\n  } while (!conv);\n  return {\n    it: MAX - it,\n    k: k,\n    idxs: idxs,\n    centroids: ks\n  };\n}\nmodule.exports = skmeans;","map":{"version":3,"names":["Distance","require","ClusterInit","eudist","mandist","dist","kmrand","kmpp","MAX","init","len","val","v","i","skmeans","data","k","initial","maxit","ks","old","idxs","conv","it","length","vlen","multi","count","_idxs","idx","Math","floor","random","push","min","Infinity","_idx","j","abs","sum","dif","_j","_j2","_i","_idx2","vsum","vect","h","_j3","ksj","sumj","oldj","cj","_h","_h2","_i2","_idx3","_j4","_j5","centroids","module","exports"],"sources":["/Users/brandonpae/Desktop/DevFestHackathon/frontend/node_modules/skmeans/main.js"],"sourcesContent":["/*jshint esversion: 6 */\n\nconst\n\tDistance = require(\"./distance.js\"),\n\tClusterInit = require(\"./kinit.js\"),\n\teudist = Distance.eudist,\n\tmandist = Distance.mandist,\n\tdist = Distance.dist,\n\tkmrand = ClusterInit.kmrand,\n\tkmpp = ClusterInit.kmpp;\n\nconst MAX = 10000;\n\n/**\n * Inits an array with values\n */\nfunction init(len,val,v) {\n\tv = v || [];\n\tfor(let i=0;i<len;i++) v[i] = val;\n\treturn v;\n}\n\nfunction skmeans(data,k,initial,maxit) {\n\tvar ks = [], old = [], idxs = [], dist = [];\n\tvar conv = false, it = maxit || MAX;\n\tvar len = data.length, vlen = data[0].length, multi = vlen>0;\n\tvar count = [];\n\n\tif(!initial) {\n\t\tlet idxs = {};\n\t\twhile(ks.length<k) {\n\t\t\tlet idx = Math.floor(Math.random()*len);\n\t\t\tif(!idxs[idx]) {\n\t\t\t\tidxs[idx] = true;\n\t\t\t\tks.push(data[idx]);\n\t\t\t}\n\t\t}\n\t}\n\telse if(initial==\"kmrand\") {\n\t\tks = kmrand(data,k);\n\t}\n\telse if(initial==\"kmpp\") {\n\t\tks = kmpp(data,k);\n\t}\n\telse {\n\t\tks = initial;\n\t}\n\n\tdo {\n\t\t// Reset k count\n\t\tinit(k,0,count);\n\n\t\t// For each value in data, find the nearest centroid\n\t\tfor(let i=0;i<len;i++) {\n\t\t\tlet min = Infinity, idx = 0;\n\t\t\tfor(let j=0;j<k;j++) {\n\t\t\t\t// Multidimensional or unidimensional\n\t\t\t\tvar dist = multi? eudist(data[i],ks[j]) : Math.abs(data[i]-ks[j]);\n\t\t\t\tif(dist<=min) {\n\t\t\t\t\tmin = dist;\n\t\t\t\t\tidx = j;\n\t\t\t\t}\n\t\t\t}\n\t\t\tidxs[i] = idx;\t// Index of the selected centroid for that value\n\t\t\tcount[idx]++;\t\t// Number of values for this centroid\n\t\t}\n\n\t\t// Recalculate centroids\n\t\tvar sum = [], old = [], dif = 0;\n\t\tfor(let j=0;j<k;j++) {\n\t\t\t// Multidimensional or unidimensional\n\t\t\tsum[j] = multi? init(vlen,0,sum[j]) : 0;\n\t\t\told[j] = ks[j];\n\t\t}\n\n\t\t// If multidimensional\n\t\tif(multi) {\n\t\t\tfor(let j=0;j<k;j++) ks[j] = [];\n\n\t\t\t// Sum values and count for each centroid\n\t\t\tfor(let i=0;i<len;i++) {\n\t\t\t\tlet\tidx = idxs[i],\t\t// Centroid for that item\n\t\t\t\t\t\tvsum = sum[idx],\t// Sum values for this centroid\n\t\t\t\t\t\tvect = data[i];\t\t// Current vector\n\n\t\t\t\t// Accumulate value on the centroid for current vector\n\t\t\t\tfor(let h=0;h<vlen;h++) {\n\t\t\t\t\tvsum[h] += vect[h];\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Calculate the average for each centroid\n\t\t\tconv = true;\n\t\t\tfor(let j=0;j<k;j++) {\n\t\t\t\tlet ksj = ks[j],\t\t// Current centroid\n\t\t\t\t\t\tsumj = sum[j],\t// Accumulated centroid values\n\t\t\t\t\t\toldj = old[j], \t// Old centroid value\n\t\t\t\t\t\tcj = count[j];\t// Number of elements for this centroid\n\n\t\t\t\t// New average\n\t\t\t\tfor(let h=0;h<vlen;h++) {\n\t\t\t\t\tksj[h] = (sumj[h])/(cj) || 0;\t// New centroid\n\t\t\t\t}\n\n\t\t\t\t// Find if centroids have moved\n\t\t\t\tif(conv) {\n\t\t\t\t\tfor(let h=0;h<vlen;h++) {\n\t\t\t\t\t\tif(oldj[h]!=ksj[h]) {\n\t\t\t\t\t\t\tconv = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// If unidimensional\n\t\telse {\n\t\t\t// Sum values and count for each centroid\n\t\t\tfor(let i=0;i<len;i++) {\n\t\t\t\tlet idx = idxs[i];\n\t\t\t\tsum[idx] += data[i];\n\t\t\t}\n\t\t\t// Calculate the average for each centroid\n\t\t\tfor(let j=0;j<k;j++) {\n\t\t\t\tks[j] = sum[j]/count[j] || 0;\t// New centroid\n\t\t\t}\n\t\t\t// Find if centroids have moved\n\t\t\tconv = true;\n\t\t\tfor(let j=0;j<k;j++) {\n\t\t\t\tif(old[j]!=ks[j]) {\n\t\t\t\t\tconv = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconv = conv || (--it<=0);\n\t}while(!conv);\n\n\treturn {\n\t\tit : MAX-it,\n\t\tk : k,\n\t\tidxs : idxs,\n\t\tcentroids : ks\n\t};\n}\n\nmodule.exports = skmeans;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}